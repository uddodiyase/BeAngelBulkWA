<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <title>BeangelBulkWA - Bulk WhatsApp Message Generator</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
       :root {
      --primary: #25D366;
      --primary-dark: #128C7E;
      --secondary: #f0f2f5;
      --text: #333;
      --text-light: #666;
      --border: #e1e1e1;
      --white: #ffffff;
      --shadow: 0 4px 12px rgba(0,0,0,0.08);
      --error: #f44336;
      --bg: #f9f9f9;
      --card-bg: #ffffff;
      --header-bg: #25D366;
      --input-bg: #ffffff;
    }

    .dark-mode {
      --primary: #00a884;
      --primary-dark: #008069;
      --secondary: #2a3942;
      --text: #e9edef;
      --text-light: #8696a0;
      --border: #303d45;
      --white: #111b21;
      --shadow: 0 4px 12px rgba(0,0,0,0.3);
      --bg: #0b141a;
      --card-bg: #111b21;
      --header-bg: #202c33;
      --input-bg: #2a3942;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      padding: 20px;
      transition: background 0.3s, color 0.3s;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--shadow);
      overflow: hidden;
      transition: all 0.3s;
    }
    
    .header {
      background: var(--header-bg);
      color: white;
      padding: 20px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background 0.3s;
    }
    
    .header h1 {
      font-weight: 600;
      font-size: 24px;
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 0;
    }
    
    .header h1 svg {
      width: 24px;
      height: 24px;
    }
    
    .theme-toggle {
      background: rgba(255,255,255,0.2);
      border: none;
      border-radius: 20px;
      padding: 8px 15px;
      color: white;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.2s;
    }
    
    .theme-toggle:hover {
      background: rgba(255,255,255,0.3);
    }
    
    .theme-toggle svg {
      width: 16px;
      height: 16px;
    }
    
    .content {
      padding: 30px;
    }
    
    .section {
      margin-bottom: 30px;
    }
    
    .section-title {
      font-size: 18px;
      font-weight: 500;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .section-title svg {
      width: 20px;
      height: 20px;
    }
    
    textarea, input, select, button {
      font-family: inherit;
      font-size: 14px;
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 10px 12px;
      transition: all 0.2s;
      background-color: var(--input-bg);
      color: var(--text);
    }
    
    textarea:focus, input:focus, select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(37, 211, 102, 0.2);
    }
    
    textarea {
      width: 100%;
      min-height: 100px;
      resize: vertical;
    }
    
    .btn {
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 6px;
      padding: 10px 16px;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s;

      min-width: 120px; /* Minimum width for better touch */
      height: 48px; /* Fixed height for consistency */
      touch-action: manipulation; /* Improve touch response */
    }
    
    .btn:hover {
      background: var(--primary-dark);
      transform: translateY(-1px);
    }
    
    .btn-secondary {
      background: var(--secondary);
      color: var(--text);
    }
    
    .btn-secondary:hover {
      background: var(--border);
    }
    
    .btn svg {
      width: 16px;
      height: 16px;
    }
    
    .params-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 15px;
    }
    
      .param-tag {
      background: var(--secondary);
      padding: 10px 15px; /* Increased padding for better touch */
      border-radius: 20px;
      font-size: 15px; /* Slightly larger font */
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: all 0.2s;
      margin: 5px 0; /* Added margin for better spacing */
      min-width: 60px; /* Minimum width for better touch */
      text-align: center;
      cursor: pointer; /* Show it's clickable */
      -webkit-tap-highlight-color: transparent; /* Remove tap highlight */
    }
    
    .param-tag button {
      background: none;
      border: none;
      color: var(--text-light);
      cursor: pointer;
      padding: 0;
      display: flex;
    }
    
    .param-tag button:hover {
      color: var(--text);
    }
    
    .input-row {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
      align-items: center;
    }
    
    .input-row input {
      flex: 1;
    }
    
    .contacts-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    
    .contacts-table th {
      background: var(--secondary);
      text-align: left;
      padding: 12px 15px;
      font-weight: 500;
      font-size: 14px;
    }
    
    .contacts-table td {
      padding: 12px 15px;
      border-bottom: 1px solid var(--border);
      vertical-align: middle;
    }
    
    .contacts-table input {
      width: 100%;
      padding: 8px 10px;
    }
    
    .action-cell {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    
    .send-btn {
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 4px;
      padding: 8px 12px;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 5px;
      white-space: nowrap;
    }
    
    .send-btn:hover {
      background: var(--primary-dark);
    }
    
    .send-btn svg {
      width: 14px;
      height: 14px;
    }
    
    .remove-btn {
      background: var(--error);
      color: white;
      border: none;
      border-radius: 4px;
      padding: 8px;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
    }
    
    .remove-btn:hover {
      background: #d32f2f;
    }
    
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-light);
    }
    
    .empty-state svg {
      width: 60px;
      height: 60px;
      margin-bottom: 15px;
      opacity: 0.6;
    }
    
    .actions {
      display: flex;
      gap: 10px;
      margin-top: 20px;
      flex-wrap: wrap;
    }
    
    .badge {
      background: var(--secondary);
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 500;
    }
    
    .preview-box {
      background: var(--secondary);
      padding: 15px;
      border-radius: 6px;
      margin-top: 15px;
      border-left: 4px solid var(--primary);
      position: relative;
      min-height: 60px;
    }

    /* Base styles for all screens */
    .input-row {
      display: flex;
      width: 100%;
      gap: 8px;
      margin-bottom: 10px;
    }

    #phoneInput {
      flex: 1;
      min-width: 0; /* Fixes flexbox overflow */
      padding: 12px 15px;
      font-size: 16px;
    }

    .add-contact-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 0 12px;
      white-space: nowrap;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      align-items: center;
      transition: all 0.2s;

      min-width: 120px; /* Minimum width for better touch */
      height: 48px; /* Fixed height for consistency */
      touch-action: manipulation; /* Improve touch response */
    }

    .add-contact-btn:hover {
      background: var(--primary-dark);
      transform: translateY(-1px);
    }
    
    .add-contact-btn-secondary {
      background: var(--secondary);
      color: var(--text);
    }
    
    .add-contact-btn-secondary:hover {
      background: var(--border);
    }
    
    .add-contact-btn svg {
      width: 16px;
      height: 16px;
    }

    /* Button text styling */
    .btn-text {
      display: inline-block;
    }

    /* Improved mobile responsive styles */
.contact-rows-container {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  margin-top: 15px;
  background: var(--card-bg);
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.contacts-table {
  width: 100%;
  min-width: 600px; /* Minimum width before scrolling */
  border-collapse: collapse;
}

.contacts-table th {
  background: var(--secondary);
  padding: 12px 10px;
  font-weight: 500;
  font-size: 14px;
  text-align: left;
  position: sticky;
  top: 0;
}

.contacts-table td {
  padding: 10px;
  border-bottom: 1px solid var(--border);
  vertical-align: middle;
}

.contacts-table input {
  width: 100%;
  padding: 10px 12px;
  font-size: 15px;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: var(--input-bg);
  box-sizing: border-box;
}

/* Add this to your existing CSS */
.input-row textarea {
  width: 100%;
}

/* Add these styles to your existing CSS */
.file-upload-container {
  margin: 15px 0;
  display: flex;
  align-items: center;
}

.modal {
  position: fixed;
  z-index: 100;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.5);
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-content {
  background: var(--card-bg);
  border-radius: 8px;
  box-shadow: var(--shadow);
  width: 90%;
  max-width: 700px;
  max-height: 80vh;
  overflow-y: auto;
}

.modal-header {
  padding: 15px 20px;
  border-bottom: 1px solid var(--border);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-header h3 {
  margin: 0;
  font-size: 18px;
}

.close-btn {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: var(--text);
}

.modal-body {
  padding: 20px;
}

.modal-footer {
  padding: 15px 20px;
  border-top: 1px solid var(--border);
  display: flex;
  justify-content: flex-end;
  gap: 10px;
}

#columnMappingTable {
  width: 100%;
  border-collapse: collapse;
}

#columnMappingTable th, 
#columnMappingTable td {
  padding: 12px 15px;
  border-bottom: 1px solid var(--border);
  text-align: left;
}

#columnMappingTable select {
  width: 100%;
  padding: 8px;
  border-radius: 4px;
  border: 1px solid var(--border);
  background: var(--input-bg);
  color: var(--text);
}


.hero-section {
  text-align: center;
  padding: 2rem 1rem;
  background: var(--header-bg); /* Use your existing header variable */
  color: var(--text); /* Use your text color variable */
  border-radius: 8px;
  margin: 1rem auto;
  max-width: 800px;
}

.features p {
  color: var(--text-light); /* Use your light text variable */
}

.hero-section h1 {
  font-size: 2.2rem;
  margin-bottom: 0.5rem;
}

.subtitle {
  font-size: 1.2rem;
  opacity: 0.9;
  margin-bottom: 1.5rem;
}

.features {
  text-align: left;
  display: inline-block;
  margin: 1rem 0;
}

/* Brand header styling */
.brand-header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  margin-bottom: 1rem;
}

.logo {
  height: 40px;
  width: auto;
}

.brand-name {
  font-size: 1.8rem;
  font-weight: 700;
  color: #fff;
  letter-spacing: 0.5px;
}

/* Update audience note */
.audience-note strong {
  color: #fff;
  font-weight: 600;
}

.hero-section::before {
  position: absolute;
  top: 10px;
  right: 20px;
  opacity: 0.2;
  font-size: 3rem;
  font-weight: bold;
}

.brand-logo svg {
  display: block;
  margin: 0 auto;
  padding: 10px;
}

/* Animation for interactivity */
.brand-logo svg {
  transition: transform 0.3s ease;
}
.brand-logo svg:hover {
  transform: scale(1.05);
}

/* Smooth transitions */
body, .brand-logo svg {
  transition: background-color 0.3s ease, fill 0.3s ease;
}

/* Footer Styles */
.footer {
  margin-top: 60px;
  padding: 25px 0;
  border-top: 1px solid var(--border);
  background-color: var(--secondary);
}

.footer-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 30px;
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  align-items: center;
}

.copyright {
  color: var(--text-light);
  font-size: 14px;
  margin: 8px 0;
}

.footer-links {
  display: flex;
  gap: 25px;
  margin: 8px 0;
}

.footer-links a {
  color: var(--text-light);
  text-decoration: none;
  font-size: 14px;
  transition: color 0.2s;
}

.footer-links a:hover {
  color: var(--primary);
}


/* FAQ Section */
.faq-section {
  margin: 40px 0;
  background-color: var(--card-bg);
  border-radius: 12px;
  box-shadow: var(--shadow);
}

.faq-container {
  max-width: 1000px;
  margin: 0 auto;
  padding: 30px;
}

.faq-section h2 {
  text-align: center;
  margin-bottom: 30px;
  color: var(--primary);
  font-size: 1.8rem;
}

.faq-category {
  margin-bottom: 30px;
}

.faq-category h3 {
  color: var(--primary-dark);
  font-size: 1.3rem;
  margin-bottom: 15px;
  padding-bottom: 8px;
  border-bottom: 2px solid var(--border);
}

.faq-item {
  margin-bottom: 15px;
  border: 1px solid var(--border);
  border-radius: 8px;
  overflow: hidden;
}

.faq-question {
  width: 100%;
  padding: 18px 25px;
  text-align: left;
  background-color: var(--secondary);
  border: none;
  color: var(--text);
  font-size: 1rem;
  font-weight: 500;
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: pointer;
  transition: background-color 0.2s;
}

.faq-question:hover {
  background-color: var(--primary);
  color: white;
}

.faq-answer {
  padding: 0 25px;
  max-height: 0;
  overflow: hidden;
  transition: all 0.3s ease;
  background-color: var(--card-bg);
  color: var(--text-light);
  line-height: 1.6;
}

.faq-answer p, .faq-answer ol, .faq-answer ul {
  margin-bottom: 15px;
}

.faq-answer ol, .faq-answer ul {
  padding-left: 20px;
}

.faq-item.active .faq-answer {
  padding: 20px 25px;
  max-height: 500px;
}

.faq-icon {
  width: 18px;
  height: 18px;
  transition: transform 0.3s ease;
}

.faq-item.active .faq-icon {
  transform: rotate(180deg);
}

/* Legal Links */
.legal-links {
  margin-top: 40px;
}

.legal-links h3 {
  text-align: center;
  margin-bottom: 20px;
  color: var(--primary-dark);
}

.legal-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
}

.legal-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
  background-color: var(--secondary);
  border-radius: 8px;
  text-decoration: none;
  color: var(--text);
  transition: transform 0.2s, box-shadow 0.2s;
}

.legal-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.legal-card svg {
  width: 40px;
  height: 40px;
  margin-bottom: 10px;
  color: var(--primary);
}
/* Mobile-specific improvements */
@media (max-width: 768px) {

  .legal-grid {
    grid-template-columns: 1fr;
  }

   .footer-container {
    flex-direction: column;
    text-align: center;
    gap: 10px;
  }
  
  .footer-links {
    flex-wrap: wrap;
    justify-content: center;
    gap: 15px;
  }
  
  .faq-container {
    padding: 20px;
  }
  
  .faq-question {
    padding: 15px 20px;
  }

  .contacts-table {
    min-width: 100%;
  }
  
  .contacts-table th,
  .contacts-table td {
    padding: 8px 6px;
    font-size: 13px;
  }
  
  .contacts-table input {
    padding: 8px 10px;
    font-size: 14px;
    min-width: 60px; /* Ensure inputs don't collapse too much */
  }
  
  .action-cell {
    min-width: 100px; /* Prevent action buttons from squeezing */
  }

  .input-row {
    flex-direction: column; /* Stack elements vertically on mobile */
    gap: 10px; /* Add some spacing between elements */
  }
  
  .input-row textarea {
    width: 100% !important; /* Force full width */
    min-width: 100% !important; /* Ensure it doesn't get smaller */
    margin: 0; /* Remove any margins that might affect width */
  }

}

/* Special handling for very small screens */
@media (max-width: 480px) {
  .contacts-table th,
  .contacts-table td {
    padding: 6px 4px;
    font-size: 12px;
  }
  
  .contacts-table input {
    padding: 6px 8px;
    font-size: 13px;
  }
  
  .param-tag {
    font-size: 12px;
    padding: 4px 8px;
  }
}
    
/* Desktop layout */
@media (min-width: 601px) {
  .input-row {
    align-items: center;
  }
  #phoneInput {
    flex: 1;
  }
  .add-contact-btn {
    min-width: 90px;
  }
}

    
    @media (max-width: 768px) {
      .content {
        padding: 20px;
      }
      
      .contacts-table {
        display: block;
        overflow-x: auto;
      }
      
      .action-cell {
        flex-direction: row;
        align-items: center;
      }
      
      .header {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
      }

      .contacts-table {
    min-width: 100%;
  }
  
  .contacts-table th,
  .contacts-table td {
    padding: 8px 6px;
    font-size: 13px;
  }
  
  .contacts-table input {
    padding: 8px 10px;
    font-size: 14px;
    min-width: 60px; /* Ensure inputs don't collapse too much */
  }
  
  .action-cell {
    min-width: 100px; /* Prevent action buttons from squeezing */
  }
  
    }

  


    /* Add these media queries at the end of your CSS */
@media (max-width: 600px) {
   .modal-content {
    width: 95%;
  }
  
  .modal-footer {
    flex-direction: column;
  }
  
  .modal-footer .btn {
    width: 100%;
  }
  
  .container {
    border-radius: 0;
    padding: 10px;
  }
  
  .content {
    padding: 15px;
  }
  
  .section {
    margin-bottom: 20px;
  }
  
  .param-tag {
    padding: 12px 18px; /* Even larger on mobile */
    font-size: 16px;
    margin: 8px 5px;
  }
  
  .contacts-table th,
  .contacts-table td {
    padding: 8px 10px;
    font-size: 14px;
  }
  
  .contacts-table input {
    padding: 6px 8px;
    font-size: 14px;
  }
  
  .input-row {
    display: grid;
    grid-template-columns: 1fr minmax(80px, 30%);
    align-items: stretch;
  }

  #phoneInput {
    width: 100%;
  }

  .add-contact-btn {
    width: 100%;
    min-width: unset;
    padding: 0 8px;
  }

  .add-contact-btn svg {
    width: 18px;
    height: 18px;
  }

  .btn-text {
    font-size: 14px;
  }
  
  .btn {
    min-width: 140px;
    height: 52px;
    font-size: 16px;
  }
  
  textarea {
    font-size: 16px;
    min-height: 120px;
  }
  
  input {
    font-size: 16px;
    padding: 12px 15px;
  }
  
  .action-cell {
    flex-direction: column;
    gap: 5px;
  }
  
  /* .send-btn, .remove-btn {
    width: 100%;
    justify-content: center;
  } */
}

/* Special handling for very small screens */
@media (max-width: 480px) {
  .contacts-table th,
  .contacts-table td {
    padding: 6px 4px;
    font-size: 12px;
  }
  
  .contacts-table input {
    padding: 6px 8px;
    font-size: 13px;
  }
  
  .param-tag {
    font-size: 12px;
    padding: 4px 8px;
  }
}
  </style>
</head>
<body>
    <div class="container">
      <div class="header">
      <h1>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-6.29-3.51c.549.246 1.104.448 1.674.594.054.016.125.034.18.034.079 0 .158-.01.237-.03.312-.084.574-.25.732-.49.158-.24.196-.517.112-.766-.09-.304-.349-.514-.632-.644-.283-.13-.68-.139-1.02.068-.349.213-.65.486-.864.8-.173.253-.434.662-.434.662s.34-.19.545-.284zM12 2a10 10 0 0 1 10 10 10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2m0-2a12 12 0 0 0-12 12 12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0z"/>
        </svg>
        Bulk WhatsApp Message Generator
      </h1>
      <button class="theme-toggle" id="themeToggle">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1-8.313-12.454z"/>
        </svg>
        <span id="themeText">Dark Mode</span>
      </button>
    </div>
    
    <div class="hero-section">
 <div class="brand-logo">
   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 80" style="max-width: 280px;">
  <!-- WhatsApp-inspired background -->
  <rect width="320" height="80" rx="15" fill="#006400"/>
  
  <!-- Chat bubble shape -->
  <path d="M30,20 H290 Q300,20 300,30 V60 Q300,70 290,70 H60 L40,80 V70 H30 Q20,70 20,60 V30 Q20,20 30,20 Z" fill="white" opacity="0.9"/>
  
  <!-- Brand name with proper spacing -->
  <text x="150" y="50" font-family="Arial, sans-serif" font-weight="bold" font-size="24" fill="#075E54" text-anchor="middle">
    <tspan fill="#128C7E">BeAngel</tspan>
    <tspan fill="#25D366" dx="5">Bulk</tspan> <!-- Added 5px spacing -->
    <tspan fill="#075E54" dx="5">WA</tspan> <!-- Added 5px spacing -->
  </text>
  
  <!-- Properly positioned WhatsApp icon -->
  <circle cx="280" cy="40" r="16" fill="#25D366" stroke="#075E54" stroke-width="2"/>
  <path d="M275,35a5,5 0 1 1 3.5,8.5l-1.5,1.5a1,1 0 0 1-1.4-1.4l1.5-1.5A3,3 0 0 0 275,37z" fill="white"/>
</svg>
  </div>


  <h1>ðŸš€ Bulk WhatsApp Message Generator</h1>
  <p class="subtitle">Send Personalized Messages to 1000+ Contacts in Minutes â€“ No Coding Needed!</p>
  
  <div class="features">
    <p>âœ” <strong>Excel/CSV Import</strong> â€“ Upload contacts instantly</p>
    <p>âœ” <strong>Dynamic Parameters</strong> â€“ {Name}, {OrderID}, etc.</p>
    <p>âœ” <strong>One-Click Send</strong> â€“ Direct to WhatsApp Web</p>
  </div>

  <p class="audience-note"><em>(By <strong>BeangelBulkWA</strong> â€“ Ideal for Businesses, Marketers & Agencies)</em></p>
</div>
    
    <div class="content">
      <div class="section">
        <div class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M21 6v12.5a2.5 2.5 0 0 1-2.5 2.5H5.5A2.5 2.5 0 0 1 3 18.5V6m0-3h18v2H3V3z"/>
            <path d="M12 8h7v2h-7V8zm0 4h7v2h-7v-2zm0 4h7v2h-7v-2zM6 8h2v2H8V8H6zm0 4h2v2H8v-2H6zm0 4h2v2H8v-2H6z"/>
          </svg>
          Message Template
        </div>
      <div class="template-container">
         <textarea id="template" placeholder="Enter your message template with placeholders like {name}, {product}, etc.">Hello {name}, your order {product} is ready for ${price}. Thanks for shopping with us!</textarea>
      </div>
        
        <div class="preview-box">
          <strong>Preview:</strong>
          <div id="messagePreview"></div>
        </div>
      </div>
      
      <div class="section">
        <div class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"/>
            <path d="M14 3v5h5m-7 4H7m10 4H7m4 4H7"/>
          </svg>
          Parameters
          <span class="badge" id="paramCount">0 parameters</span>
        </div>
        <div class="params-container" id="paramList"></div>
        <button class="btn" onclick="addParameter()">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
          </svg>
          Add Parameter
        </button>
      </div>
      
      <div class="section">
        <div class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
          </svg>
          Contact Details
        </div>
        
        <div class="input-row">
        <input type="text" id="phoneInput" placeholder="Phone number (e.g. 911234567890)">
        <button class="add-contact-btn" onclick="addContact()">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
          </svg>
          <span class="btn-text">Add</span>
        </button>
      </div>
        
        <div class="template-container">
          <textarea id="bulkInput" placeholder="Or paste bulk data (one contact per line, comma-separated values: phone,name,product,price,etc.)"></textarea>
        </div>

        <!-- Add this to your HTML in the Contact Details section, after the bulkInput textarea -->
      <div class="file-upload-container">
        <input type="file" id="excelFile" accept=".xlsx,.xls,.csv" style="display: none;">
        <button class="btn btn-secondary" onclick="document.getElementById('excelFile').click()">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"/>
          </svg>
          Import Excel/CSV
        </button>
        <span id="fileName" style="margin-left: 10px; color: var(--text-light);"></span>
      </div>
        
        <div class="actions">
          <button class="btn" onclick="parseBulkInput()">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path d="M13 2.05v3.03c3.39.49 6 3.39 6 6.92 0 .9-.18 1.75-.5 2.54l2.62 1.53c.56-1.24.88-2.62.88-4.07 0-5.18-3.95-9.45-9-9.95zM12 19c-3.87 0-7-3.13-7-7 0-3.53 2.61-6.43 6-6.92V2.05c-5.06.5-9 4.76-9 9.95 0 5.52 4.47 10 9.99 10 3.31 0 6.24-1.61 8.06-4.09l-2.6-1.53C16.17 17.98 14.21 19 12 19z"/>
            </svg>
            Parse Bulk Data
          </button>
          <button class="btn btn-secondary" onclick="addEmptyRow()">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
            </svg>
            Add Empty Row
          </button>
          <button class="btn btn-secondary" onclick="clearAll()">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path d="M19 4h-3.5l-1-1h-5l-1 1H5v2h14zM6 7v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6z"/>
            </svg>
            Clear All
          </button>
        </div>
      </div>
      
      <div class="section">
        <div class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 9h12v2H6V9zm8 5H6v-2h8v2zm4-6H6V6h12v2z"/>
          </svg>
          Message Preview & Send
        </div>
        
        <div id="contactsContainer">
          <table class="contacts-table">
            <thead>
              <tr id="tableHeader"></tr>
            </thead>
            <tbody id="contactRows">
              <tr class="empty-state">
                <td colspan="100">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 9h12v2H6V9zm8 5H6v-2h8v2zm4-6H6V6h12v2z"/>
                  </svg>
                  <p>No contacts added yet. Add contacts individually or paste bulk data.</p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

        <div id="columnMappingModal" class="modal" style="display: none;">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Map Excel Columns to Parameters</h3>
            <button onclick="closeColumnMapping()" class="close-btn">&times;</button>
          </div>
          <div class="modal-body">
            <table id="columnMappingTable">
              <thead>
                <tr>
                  <th>Excel Column</th>
                  <th>Map to Parameter</th>
                </tr>
              </thead>
              <tbody id="columnMappingBody"></tbody>
            </table>
          </div>
          <div class="modal-footer">
            <button class="btn" onclick="processMappedData()">Import Data</button>
            <button class="btn btn-secondary" onclick="closeColumnMapping()">Cancel</button>
          </div>
        </div>
      </div>

    </div>

 <div class="faq-section" id="faqSection" style="display: none;">
  <div class="faq-container">
    <h2>Frequently Asked Questions</h2>
    
    <div class="faq-category">
      <h3>General Questions</h3>
      
      <div class="faq-item">
        <button class="faq-question">
          What is a BeangelBulkWA?
          <svg class="faq-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M7 10l5 5 5-5z"/>
          </svg>
        </button>
        <div class="faq-answer">
          <p>A BeangelBulkWA is a tool that allows you to quickly send auto-personalized messages to multiple people without adding them to your phonebook. It's useful for contacting new leads or following up with existing clients quickly, without the limitations of WhatsApp Broadcast Lists or Group Chats.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question">
          How does this bulk WhatsApp sender work?
          <svg class="faq-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M7 10l5 5 5-5z"/>
          </svg>
        </button>
        <div class="faq-answer">
          <ol>
            <li>Customize your message in the Message Template field (use {name} for personalization)</li>
            <li>Add contacts via Excel/CSV or manual entry</li>
            <li>Click send for each recipient (opens official WhatsApp for sending)</li>
          </ol>
          <p>This method complies with WhatsApp's policies as it requires manual sending for each recipient.</p>
        </div>
      </div>
    </div>

    <div class="faq-category">
      <h3>Legal & Safety</h3>
      
      <div class="faq-item">
        <button class="faq-question">
          Is using this tool legal?
          <svg class="faq-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M7 10l5 5 5-5z"/>
          </svg>
        </button>
        <div class="faq-answer">
          <p>Yes, using this tool is legal when used responsibly. It complies with WhatsApp's Terms of Service because:</p>
          <ul>
            <li>No automation - requires manual sending per recipient</li>
            <li>Uses official WhatsApp interface</li>
            <li>No access to your WhatsApp data</li>
          </ul>
          <p>Avoid spamming or sending unsolicited messages as this may lead to account restrictions.</p>
        </div>
      </div>
    </div>

    <div class="faq-category">
      <h3>Features & Limitations</h3>
      
      <div class="faq-item">
        <button class="faq-question">
          Can I send media files?
          <svg class="faq-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M7 10l5 5 5-5z"/>
          </svg>
        </button>
        <div class="faq-answer">
          <p>Currently, the tool supports text, links, and emojis. When sending:</p>
          <ul>
            <li>You can manually attach media in WhatsApp after the text is inserted</li>
            <li>Bulk media sending isn't supported due to WhatsApp limitations</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="legal-links">
      <h3>Legal Information</h3>
      <div class="legal-grid">
        <a href="privacy.html" class="legal-card">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11V11.99z"/>
          </svg>
          <span>Privacy Policy</span>
        </a>
        <a href="terms.html" class="legal-card">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/>
          </svg>
          <span>Terms of Service</span>
        </a>
        <a href="contact.html" class="legal-card">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/>
          </svg>
          <span>Contact Us</span>
        </a>
      </div>
    </div>
  </div>
</div>


   <div class="footer">
    <div class="footer-container">
      <div class="copyright">
        &copy; <span id="year"></span> BeangelBulkWA. All rights reserved.
      </div>
      <div class="footer-links">
        <a href="javascript:void(0)" onclick="showFaq()">FAQ</a>
        <a href="privacy.html">Privacy Policy</a>
        <a href="terms.html">Terms of Service</a>
        <a href="contact.html">Contact</a>
      </div>
    </div>
  </div>
    
  
  </div>   <!-- Main Div Close -->

  <script>
    let parameters = ['name', 'product', 'price']; // Default parameters
    let contacts = [];
    let isDarkMode = true;
    let excelData = [];
    let fileColumns = [];

    
    // Initialize the app
    document.addEventListener('DOMContentLoaded', function() {
      renderParameterList();
      addEmptyRow();
      addEmptyRow();
      addEmptyRow();
      addEmptyRow();
      addEmptyRow();
      updateMessagePreview();
      
      // Add event listeners for template changes
      document.getElementById('template').addEventListener('input', updateMessagePreview);
      
      // Initialize theme
      checkThemePreference();

      // Handle parameter tag clicks (for inserting into template)
      document.getElementById('paramList').addEventListener('click', function(e) {
        // Check if the click was on the remove button
        if (e.target.closest('.param-tag button')) {
          e.stopPropagation(); // Prevent the click from bubbling up
          return;
        }
        
        // Check if the click was on the parameter tag itself
        const paramTag = e.target.closest('.param-tag');
        if (paramTag) {
          const template = document.getElementById('template');
          const param = paramTag.textContent.trim().replace(/[{}]/g, '').replace('Ã—', '').trim();
          const cursorPos = template.selectionStart;
          const text = template.value;
          
          template.value = text.substring(0, cursorPos) + `{${param}}` + text.substring(cursorPos);
          updateMessagePreview();
          
          template.focus();
          template.setSelectionRange(cursorPos + param.length + 2, cursorPos + param.length + 2);
        }
      });

      // Handle touch events for mobile
      document.getElementById('paramList').addEventListener('touchend', function(e) {
        // Check if the touch was on the remove button
        if (e.target.closest('.param-tag button')) {
          e.stopPropagation(); // Prevent the touch from bubbling up
          return;
        }
        
        // Check if the touch was on the parameter tag itself
        const paramTag = e.target.closest('.param-tag');
        if (paramTag) {
          const template = document.getElementById('template');
          const param = paramTag.textContent.trim().replace(/[{}]/g, '').replace('Ã—', '').trim();
          const cursorPos = template.selectionStart;
          const text = template.value;
          
          template.value = text.substring(0, cursorPos) + `{${param}}` + text.substring(cursorPos);
          updateMessagePreview();
          
          template.focus();
          template.setSelectionRange(cursorPos + param.length + 2, cursorPos + param.length + 2);
          
          // Prevent default behavior to avoid zooming
          e.preventDefault();
        }
      }, { passive: false });
    });
    
    function checkThemePreference() {
      //Default Light Mode
      // const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      // if (prefersDark) {
      //   toggleDarkMode();
      // }

      //Default Dark Mode
            const savedTheme = localStorage.getItem('darkMode');
        const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        // Default to dark unless user has explicitly chosen light
        if (savedTheme === null) {
          document.body.classList.add('dark-mode');
          localStorage.setItem('darkMode', 'true');
          document.getElementById('themeText').textContent = 'Light Mode';
        } 
        else if (savedTheme === 'true') {
          document.body.classList.add('dark-mode');
          document.getElementById('themeText').textContent = 'Light Mode';
        }
    }
    
    function toggleDarkMode() {
      isDarkMode = !isDarkMode;
      document.body.classList.toggle('dark-mode', isDarkMode);
      document.getElementById('themeText').textContent = isDarkMode ? 'Light Mode' : 'Dark Mode';

      // Update theme icon
      const themeIcon = document.querySelector('#themeToggle svg');
      if (isDarkMode) {
        themeIcon.innerHTML = '<path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"/>';
      } else {
        themeIcon.innerHTML = '<path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1-8.313-12.454z"/>';
      }
      
      // Save preference to localStorage
      localStorage.setItem('darkMode', isDarkMode);
    }
    
    function updateMessagePreview() {
      const template = document.getElementById('template').value;
      let preview = template;
      
      // Replace all parameters with sample values
      parameters.forEach(p => {
        preview = preview.replace(new RegExp(`{${p}}`, 'g'), `<span style="color: var(--primary); font-weight: 500;">[${p}]</span>`);
      });
      
      document.getElementById('messagePreview').innerHTML = preview;
    }
    
    function addParameter() {
      const paramName = prompt("Enter parameter name (e.g., name, product, price):", "param" + (parameters.length + 1));
      if (paramName && !parameters.includes(paramName)) {
        parameters.push(paramName);
         refreshParameters();
        renderParameterList();
        updateTableHeader();
        updateContactRows();
        updateMessagePreview();
      }
    }
    
    function removeParameter(paramName) {
      parameters = parameters.filter(p => p !== paramName);
      refreshParameters();
      renderParameterList();
      updateTableHeader();
      updateContactRows();
      updateMessagePreview();
    }
    
    function renderParameterList() {
      const paramList = document.getElementById("paramList");
      paramList.innerHTML = '';
      
      parameters.forEach(p => {
        const tag = document.createElement('div');
        tag.className = 'param-tag';
        tag.innerHTML = `
          {${p}}
          <button onclick="event.stopPropagation(); removeParameter('${p}')" title="Remove parameter">
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
              <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
            </svg>
          </button>
        `;
        tag.title = `Click to insert {${p}} at cursor position`;
        paramList.appendChild(tag);
      });
      
      document.getElementById("paramCount").textContent = `${parameters.length} parameter${parameters.length !== 1 ? 's' : ''}`;
    }
    
    function addContact() {
      const phone = document.getElementById("phoneInput").value.trim();
      if (!phone) return;
      
      // First try to find an empty row (phone number empty)
      const emptyRowIndex = contacts.findIndex(c => !c.phone);
      
      if (emptyRowIndex !== -1) {
        // Fill existing empty row
        contacts[emptyRowIndex].phone = phone;
      } else {
        // Add new row
        const contact = { phone };
        parameters.forEach(p => contact[p] = '');
        contacts.push(contact);
      }
      
      renderContactRows();
      document.getElementById("phoneInput").value = '';
    }
    
    function addEmptyRow() {
      const contact = { phone: '' };
      parameters.forEach(p => contact[p] = '');
      contacts.push(contact);
      renderContactRows();
    }
    
    function parseBulkInput() {
      const bulkText = document.getElementById("bulkInput").value.trim();
      if (!bulkText) return;
      
      const lines = bulkText.split('\n').filter(line => line.trim());
      
      // First try to fill existing empty rows
      let emptyRowIndex = contacts.findIndex(c => !c.phone);
      
      lines.forEach(line => {
        const values = line.split(',').map(v => v.trim());
        if (values.length === 0) return;
        
        // Skip if all values are empty
        if (values.every(v => !v)) return;
        
        if (emptyRowIndex !== -1) {
          // Fill existing empty row
          contacts[emptyRowIndex].phone = values[0] || '';
          parameters.forEach((p, i) => {
            contacts[emptyRowIndex][p] = values[i + 1] || '';
          });
          // Find next empty row
          emptyRowIndex = contacts.findIndex((c, idx) => idx > emptyRowIndex && !c.phone);
        } else {
          // Add new row if no empty rows left
          const contact = { phone: values[0] || '' };
          parameters.forEach((p, i) => {
            contact[p] = values[i + 1] || '';
          });
          contacts.push(contact);
        }
      });
      
      renderContactRows();
      document.getElementById("bulkInput").value = '';
    }
    
    function updateTableHeader() {
      const headerRow = document.getElementById("tableHeader");
      headerRow.innerHTML = `
        <th>Phone</th>
        ${parameters.map(p => `<th>${p}</th>`).join('')}
        <th>Actions</th>
      `;
    }
    
    function updateContactRows() {
      contacts.forEach(contact => {
        // Ensure contact has all current parameters
        parameters.forEach(p => {
          if (!contact.hasOwnProperty(p)) {
            contact[p] = '';
          }
        });
      });
      renderContactRows();
    }
    
    function renderContactRows() {
      const rowsContainer = document.getElementById("contactRows");
      
      if (contacts.length === 0) {
        rowsContainer.innerHTML = `
          <tr class="empty-state">
            <td colspan="${parameters.length + 2}">
              <div class="empty-message">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 9h12v2H6V9zm8 5H6v-2h8v2zm4-6H6V6h12v2z"/>
                </svg>
                <p>No contacts added yet</p>
              </div>
            </td>
          </tr>
        `;
        return;
      }
      
      updateTableHeader();
      
      rowsContainer.innerHTML = contacts.map((contact, index) => {
        return `
          <tr>
            <td>
              <input type="text" 
                     value="${contact.phone || ''}" 
                     onchange="updateContact(${index}, 'phone', this.value)" 
                     placeholder="Phone"
                     class="phone-input">
            </td>
            ${parameters.map(p => `
              <td>
                <input type="text" 
                       value="${contact[p] || ''}" 
                       onchange="updateContact(${index}, '${p}', this.value)" 
                       placeholder="${p}"
                       class="param-input">
              </td>
            `).join('')}
            <td class="action-cell">
              <button class="send-btn" onclick="sendMessage(${index})">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                </svg>
                <span class="btn-label">Send</span>
              </button>
              <button class="remove-btn" onclick="removeContact(${index})" title="Remove">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
              </button>
            </td>
          </tr>
        `;
      }).join('');
    }
    
    function updateContact(index, field, value) {
      contacts[index][field] = value;
    }
    
    function removeContact(index) {
      contacts.splice(index, 1);
      renderContactRows();
    }
    
    function clearAll() {
      if (confirm("Are you sure you want to clear all contacts?")) {
        contacts = [];
        renderContactRows();
      }
    }
    
    function sendMessage(index) {
      const contact = contacts[index];
      if (!contact.phone) {
        alert("Please enter a phone number");
        return;
      }
      
      let message = document.getElementById("template").value;
      parameters.forEach(p => {
        message = message.replace(new RegExp(`{${p}}`, 'g'), contact[p] || '');
      });
      
      // Format phone number (remove any non-digit characters)
      const phone = contact.phone.replace(/\D/g, '');
      
      // Open WhatsApp with the message
      const url = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
      window.open(url, '_blank');
    }

    // Add this event listener with your other event listeners
document.getElementById('excelFile').addEventListener('change', handleFileUpload);

// Add these new functions to your existing script
function handleFileUpload(event) {
  const file = event.target.files[0];
  if (!file) return;

  document.getElementById('fileName').textContent = file.name;
  
  const reader = new FileReader();
  reader.onload = function(e) {
    try {
      // Check if XLSX library is available
      if (typeof XLSX === 'undefined') {
        throw new Error("XLSX library not loaded. Please refresh the page.");
      }

      let jsonData;
      const fileType = file.name.split('.').pop().toLowerCase();

      if (fileType === 'csv') {
        // Process CSV file
        const csvString = e.target.result;
        jsonData = csvString.split('\n')
          .map(row => row.split(',').map(cell => cell.trim()));
      } else {
        // Process Excel file
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });
        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
        jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
      }

      if (!jsonData || jsonData.length === 0) {
        throw new Error("The file is empty or couldn't be read");
      }

      // Get headers (first row)
      fileColumns = jsonData[0];
      
      // Validate phone column exists
      if (!fileColumns || fileColumns.length === 0) {
        throw new Error("No columns found in the file");
      }

      // Check if first column is phone (case insensitive)
      const firstCol = String(fileColumns[0]).toLowerCase();
      if (!firstCol.includes('phone') && !firstCol.includes('number') && !firstCol.includes('mobile')) {
        if (!confirm("The first column doesn't appear to be phone numbers. Continue anyway?")) {
          return;
        }
      }

      excelData = jsonData.slice(1); // Remove header row
      showColumnMapping();

    } catch (error) {
      console.error("Error reading file:", error);
      alert(`Error: ${error.message}\n\nPlease check:\n1. File contains valid data\n2. First column has phone numbers\n3. File is not corrupted`);
    }
  };

  if (file.name.toLowerCase().endsWith('.csv')) {
    reader.readAsText(file);
  } else {
    reader.readAsArrayBuffer(file);
  }
}

function showColumnMapping() {
  const modal = document.getElementById('columnMappingModal');
  const tbody = document.getElementById('columnMappingBody');
  tbody.innerHTML = '';

  // 1. PHONE (fixed first row, required)
  const phoneRow = document.createElement('tr');
  
  // Parameter Cell
  const phoneParamCell = document.createElement('td');
  phoneParamCell.innerHTML = `
    <strong>Phone</strong>
    <span class="required-badge">(required)</span>
  `;
  
  // Mapping Cell
  const phoneMapCell = document.createElement('td');
  const phoneSelect = document.createElement('select');
  phoneSelect.className = 'mapping-select';
  phoneSelect.dataset.param = 'phone';
  phoneSelect.required = true;
  
  // Default empty option
  phoneSelect.appendChild(new Option("-- Select phone column --", ""));
  
  // Add file columns as options
  fileColumns.forEach((col, colIndex) => {
    const option = new Option(col, colIndex);
    // Auto-select if column name suggests phone numbers
    if (/phone|mobile|number|contact/i.test(col.toLowerCase())) {
      option.selected = true;
    }
    phoneSelect.appendChild(option);
  });
  
  phoneMapCell.appendChild(phoneSelect);
  phoneRow.appendChild(phoneParamCell);
  phoneRow.appendChild(phoneMapCell);
  tbody.appendChild(phoneRow);

  // 2. OTHER PARAMETERS (dynamic)
  parameters.filter(p => p !== 'phone').forEach(param => {
    const row = document.createElement('tr');
    
    // Parameter Cell
    const paramCell = document.createElement('td');
    paramCell.innerHTML = `<strong>${param}</strong>`;
    
    // Mapping Cell
    const mapCell = document.createElement('td');
    const select = document.createElement('select');
    select.className = 'mapping-select';
    select.dataset.param = param;
    
    // Default empty option
    select.appendChild(new Option("-- Skip this parameter --", ""));
    
    // Add file columns as options
    fileColumns.forEach((col, colIndex) => {
      const option = new Option(col, colIndex);
      
      // Auto-select if column name matches parameter
      const colNormalized = col.toLowerCase().replace(/\s+/g, '');
      const paramNormalized = param.toLowerCase().replace(/\s+/g, '');
      
      if (colNormalized.includes(paramNormalized) || 
          paramNormalized.includes(colNormalized)) {
        option.selected = true;
      }
      
      select.appendChild(option);
    });
    
    mapCell.appendChild(select);
    row.appendChild(paramCell);
    row.appendChild(mapCell);
    tbody.appendChild(row);
  });

  // Show modal
  modal.style.display = 'flex';
}

function closeColumnMapping() {
  document.getElementById('columnMappingModal').style.display = 'none';
  document.getElementById('excelFile').value = '';
  document.getElementById('fileName').textContent = '';
}

function processMappedData() {
  console.log("Starting import process...");
  
  // 1. Verify phone is mapped
  const phoneSelect = document.querySelector('select[data-param="phone"]');
  const phoneColIndex = parseInt(phoneSelect.value);
  
  if (isNaN(phoneColIndex)) {
    alert("Error: You must select a column for phone numbers");
    return;
  }

  // 2. Create parameter mapping
  const paramMap = {
    phone: {
      colIndex: phoneColIndex,
      colName: fileColumns[phoneColIndex]
    }
  };

  // 3. Map other parameters
  parameters.filter(p => p !== 'phone').forEach(param => {
    const select = document.querySelector(`select[data-param="${param}"]`);
    const colIndex = parseInt(select.value);
    
    if (!isNaN(colIndex)) {
      paramMap[param] = {
        colIndex: colIndex,
        colName: fileColumns[colIndex]
      };
    }
  });

  // 4. Process data rows
  const newContacts = [];
  
  excelData.forEach((row, rowIndex) => {
    if (!row || row.length === 0) return;
    
    const contact = {};
    let hasPhone = false;
    
    // Map values using paramMap
    Object.entries(paramMap).forEach(([param, mapping]) => {
      if (row[mapping.colIndex] !== undefined) {
        contact[param] = String(row[mapping.colIndex]).trim();
        if (param === 'phone' && contact[param]) {
          hasPhone = true;
          // Format phone number
          contact[param] = contact[param].replace(/\D/g, '');
        }
      }
    });
    
    // Only add if phone exists and is valid
    if (hasPhone && contact.phone.length >= 8) {
      // Ensure all parameters exist in contact
      parameters.forEach(p => {
        if (!contact.hasOwnProperty(p)) {
          contact[p] = '';
        }
      });
      newContacts.push(contact);
    }
  });
  
  // 5. Add to contacts
  if (newContacts.length > 0) {
    // Find empty rows to replace first
    const emptyIndices = [];
    contacts.forEach((contact, index) => {
      if (!contact.phone || contact.phone.trim() === '') {
        emptyIndices.push(index);
      }
    });
    
    // Fill empty rows first
    let filledCount = 0;
    while (filledCount < emptyIndices.length && filledCount < newContacts.length) {
      contacts[emptyIndices[filledCount]] = newContacts[filledCount];
      filledCount++;
    }
    
    // Add remaining as new rows
    if (filledCount < newContacts.length) {
      contacts.push(...newContacts.slice(filledCount));
    }
    
    renderContactRows();
    closeColumnMapping();
    
    const addedNew = newContacts.length - filledCount;
    alert(`Imported ${newContacts.length} contacts:
- Filled ${filledCount} empty rows
- Added ${addedNew} new contacts`);
  } else {
    alert("No valid contacts imported. Please check:\n1. Phone column is correct\n2. Phone numbers exist\n3. Data is valid");
  }
}

function refreshParameters() {
  renderParameterList();
  updateTableHeader();
  updateContactRows();
  updateMessagePreview();
  
  // If mapping modal is open, refresh it
  if (document.getElementById('columnMappingModal').style.display === 'flex') {
    showColumnMapping();
  }
}

// Theme toggle event listener
document.getElementById('themeToggle').addEventListener('click', toggleDarkMode);

//Check for saved theme preference
if (localStorage.getItem('darkMode') === true) {
  toggleDarkMode();
}



// Set copyright year
document.getElementById('year').textContent = new Date().getFullYear();

// FAQ toggle function
function showFaq() {
  const faqSection = document.getElementById('faqSection');
  faqSection.style.display = faqSection.style.display === 'none' ? 'block' : 'none';
  if (faqSection.style.display === 'block') {
    faqSection.scrollIntoView({ behavior: 'smooth' });
  }
}

// Update FAQ toggle for smooth animation
// Enhanced FAQ toggle with smooth scrolling
document.querySelectorAll('.faq-question').forEach(question => {
  question.addEventListener('click', () => {
    const item = question.parentElement;
    const wasActive = item.classList.contains('active');
    
    // Close all items first
    document.querySelectorAll('.faq-item').forEach(i => {
      i.classList.remove('active');
    });
    
    // Open current if it wasn't active
    if (!wasActive) {
      item.classList.add('active');
      // Smooth scroll to keep question visible
      setTimeout(() => {
        item.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }, 300);
    }
  });
});

// Show FAQ section from footer link
function showFaq() {
  const faqSection = document.getElementById('faqSection');
  faqSection.style.display = 'block';
  faqSection.scrollIntoView({ behavior: 'smooth' });
  
  // Open first category by default
  const firstQuestion = document.querySelector('.faq-question');
  if (firstQuestion) {
    firstQuestion.click();
  }
}
  </script>
</body>
</html>